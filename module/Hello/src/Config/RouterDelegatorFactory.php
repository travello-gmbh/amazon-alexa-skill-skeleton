<?php
/**
 * PHP skeleton application for Amazon Alexa Skills
 *
 * @author     Ralf Eggert <ralf@travello.audio>
 * @license    http://opensource.org/licenses/MIT The MIT License (MIT)
 * @link       https://github.com/travello-gmbh/amazon-alexa-skill-skeleton
 * @link       https://www.travello.audio/
 */

namespace Hello\Config;

use Hello\Action\HelloAction;
use Hello\Action\PrivacyAction;
use Hello\Application\HelloApplication;
use Interop\Container\ContainerInterface;
use Zend\Expressive\Application;
use Zend\ServiceManager\Factory\DelegatorFactoryInterface;

/**
 * Class RouterDelegatorFactory
 *
 * @package Hello\Config
 */
class RouterDelegatorFactory implements DelegatorFactoryInterface
{
    /**
     * @param ContainerInterface $container
     * @param string             $name
     * @param callable           $callback
     * @param array|null|null    $options
     *
     * @return mixed
     */
    public function __invoke(ContainerInterface $container, $name, callable $callback, array $options = null)
    {
        /** @var Application $application */
        $application = $callback();

        $application->post(
            '/hello',
            HelloAction::class,
            'hello'
        )->setOptions(['defaults' => ['skillName' => HelloApplication::NAME]]);

        $application->route(
            '/hello/privacy',
            PrivacyAction::class,
            ['GET', 'POST'],
            'hello-privacy'
        );

        return $application;
    }
}
